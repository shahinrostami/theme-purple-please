"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _lodash = _interopRequireDefault(require("lodash"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var _default = (app, selfPath) => {
  // Hook for tests only
  app.get('/-/_debug', function (req, res, next) {
    const doGarbabeCollector = _lodash.default.isNil(global.gc) === false;

    if (doGarbabeCollector) {
      global.gc();
    }

    next({
      pid: process.pid,
      // @ts-ignore
      main: process.mainModule.filename,
      conf: selfPath,
      mem: process.memoryUsage(),
      gc: doGarbabeCollector
    });
  });
};

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9hcGkvZGVidWcvaW5kZXgudHMiXSwibmFtZXMiOlsiYXBwIiwic2VsZlBhdGgiLCJnZXQiLCJyZXEiLCJyZXMiLCJuZXh0IiwiZG9HYXJiYWJlQ29sbGVjdG9yIiwiXyIsImlzTmlsIiwiZ2xvYmFsIiwiZ2MiLCJwaWQiLCJwcm9jZXNzIiwibWFpbiIsIm1haW5Nb2R1bGUiLCJmaWxlbmFtZSIsImNvbmYiLCJtZW0iLCJtZW1vcnlVc2FnZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOzs7O2VBSWUsQ0FBQ0EsR0FBRCxFQUFtQkMsUUFBbkIsS0FBOEM7QUFDM0Q7QUFDQUQsRUFBQUEsR0FBRyxDQUFDRSxHQUFKLENBQ0UsV0FERixFQUVFLFVBQVVDLEdBQVYsRUFBK0JDLEdBQS9CLEVBQXFEQyxJQUFyRCxFQUFtRjtBQUNqRixVQUFNQyxrQkFBa0IsR0FBR0MsZ0JBQUVDLEtBQUYsQ0FBUUMsTUFBTSxDQUFDQyxFQUFmLE1BQXVCLEtBQWxEOztBQUVBLFFBQUlKLGtCQUFKLEVBQXdCO0FBQ3RCRyxNQUFBQSxNQUFNLENBQUNDLEVBQVA7QUFDRDs7QUFFREwsSUFBQUEsSUFBSSxDQUFDO0FBQ0hNLE1BQUFBLEdBQUcsRUFBRUMsT0FBTyxDQUFDRCxHQURWO0FBRUg7QUFDQUUsTUFBQUEsSUFBSSxFQUFFRCxPQUFPLENBQUNFLFVBQVIsQ0FBbUJDLFFBSHRCO0FBSUhDLE1BQUFBLElBQUksRUFBRWYsUUFKSDtBQUtIZ0IsTUFBQUEsR0FBRyxFQUFFTCxPQUFPLENBQUNNLFdBQVIsRUFMRjtBQU1IUixNQUFBQSxFQUFFLEVBQUVKO0FBTkQsS0FBRCxDQUFKO0FBUUQsR0FqQkg7QUFtQkQsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyBBcHBsaWNhdGlvbiB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHsgJFJlc3BvbnNlRXh0ZW5kLCAkUmVxdWVzdEV4dGVuZCwgJE5leHRGdW5jdGlvblZlciB9IGZyb20gJy4uLy4uLy4uL3R5cGVzJztcblxuZXhwb3J0IGRlZmF1bHQgKGFwcDogQXBwbGljYXRpb24sIHNlbGZQYXRoOiBzdHJpbmcpOiB2b2lkID0+IHtcbiAgLy8gSG9vayBmb3IgdGVzdHMgb25seVxuICBhcHAuZ2V0KFxuICAgICcvLS9fZGVidWcnLFxuICAgIGZ1bmN0aW9uIChyZXE6ICRSZXF1ZXN0RXh0ZW5kLCByZXM6ICRSZXNwb25zZUV4dGVuZCwgbmV4dDogJE5leHRGdW5jdGlvblZlcik6IHZvaWQge1xuICAgICAgY29uc3QgZG9HYXJiYWJlQ29sbGVjdG9yID0gXy5pc05pbChnbG9iYWwuZ2MpID09PSBmYWxzZTtcblxuICAgICAgaWYgKGRvR2FyYmFiZUNvbGxlY3Rvcikge1xuICAgICAgICBnbG9iYWwuZ2MoKTtcbiAgICAgIH1cblxuICAgICAgbmV4dCh7XG4gICAgICAgIHBpZDogcHJvY2Vzcy5waWQsXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgbWFpbjogcHJvY2Vzcy5tYWluTW9kdWxlLmZpbGVuYW1lLFxuICAgICAgICBjb25mOiBzZWxmUGF0aCxcbiAgICAgICAgbWVtOiBwcm9jZXNzLm1lbW9yeVVzYWdlKCksXG4gICAgICAgIGdjOiBkb0dhcmJhYmVDb2xsZWN0b3JcbiAgICAgIH0pO1xuICAgIH1cbiAgKTtcbn07XG4iXX0=